接口描述
支持对不同版式银行回单进行结构化识别，包括标题、付款人户名、付款人开户银行、付款人账号、收款人户名、收款人开户银行、收款人账号、大写金额、小写金额、流水号、回单编号、交易日期、摘要、用途 14个关键字段。

在线调试
您可以在 示例代码中心 中调试该接口，可进行签名验证、查看在线调用的请求内容和返回结果、示例代码的自动生成。

请求说明
请求示例

HTTP 方法：POST

请求URL： https://aip.baidubce.com/rest/2.0/ocr/v1/bank_receipt_new

URL参数：

参数	值
access_token	通过API Key和Secret Key获取的access_token，参考“Access Token获取”
Header如下：

参数	值
Content-Type	application/x-www-form-urlencoded
Body中放置请求参数，参数详情如下：

请求参数

参数	是否必选	类型	可选值范围	说明
image	和 url/pdf_file/ofd_file 四选一	string	-	图像数据，base64编码后进行urlencode，要求base64编码和urlencode后大小不超过8M，最短边至少15px，最长边最大4096px，支持jpg/jpeg/png/bmp格式
优先级：image > url > pdf_file > ofd_file ，当image字段存在时，url、pdf_file、ofd_file 字段失效
url	和 image/pdf_file/ofd_file 四选一	string	-	图片完整url，url长度不超过1024字节，url对应的图片base64编码后大小不超过8M，最短边至少15px，最长边最大4096px，支持jpg/jpeg/png/bmp格式
优先级：image > url > pdf_file > ofd_file，当image字段存在时，url字段失效
请注意关闭URL防盗链
pdf_file	和 image/url/ofd_file 四选一	string	-	PDF文件，base64编码后进行urlencode，要求base64编码和urlencode后大小不超过8M，最短边至少15px，最长边最大4096px
优先级：image > url > pdf_file > ofd_file，当image、url字段存在时，pdf_file字段失效
pdf_file_num	否	string	-	需要识别的PDF文件的对应页码，当 pdf_file 参数有效时，识别传入页码的对应页面内容，若不传入，则默认识别第 1 页
ofd_file	和 image/url/pdf_file 四选一	string	-	OFD文件，base64编码后进行urlencode，要求base64编码和urlencode后大小不超过8M，最短边至少15px，最长边最大4096px
优先级：image > url > pdf_file > ofd_file，当image、url、pdf_file字段存在时，ofd_file字段失效
ofd_file_num	否	string	-	需要识别的OFD文件的对应页码，当 ofd_file 参数有效时，识别传入页码的对应页面内容，若不传入，则默认识别第 1 页
probability	否	string	true/false	是否返回字段置信度，默认为 false ，即不返回
location	否	string	true/false	是否返回字段位置坐标，默认为 false，即不返回
请求代码示例

提示一：使用示例代码前，请记得替换其中的示例Token、图片地址或Base64信息。

提示二：部分语言依赖的类或库，请在代码注释中查看下载地址。

copy code
```bash label=Bash
curl -i -k 'https://aip.baidubce.com/rest/2.0/ocr/v1/bank_receipt_new?access_token=【调用鉴权接口获取的token】' --data 'image=【图片Base64编码，需UrlEncode】' -H 'Content-Type:application/x-www-form-urlencoded'
```
```python label=Python
# encoding:utf-8

import requests
import base64

'''
银行回单识别
'''

request_url = "https://aip.baidubce.com/rest/2.0/ocr/v1/bank_receipt_new"
# 二进制方式打开图片文件
f = open('[本地文件]', 'rb')
img = base64.b64encode(f.read())

params = {"image":img}
access_token = '[调用鉴权接口获取的token]'
request_url = request_url + "?access_token=" + access_token
headers = {'content-type': 'application/x-www-form-urlencoded'}
response = requests.post(request_url, data=params, headers=headers)
if response:
    print (response.json())

```
```java label=JAVA
package com.baidu.ai.aip;

import com.baidu.ai.aip.utils.Base64Util;
import com.baidu.ai.aip.utils.FileUtil;
import com.baidu.ai.aip.utils.HttpUtil;

import java.net.URLEncoder;

/**
* 银行回单识别
*/
public class BankReceiptNew{

    /**
    * 重要提示代码中所需工具类
    * FileUtil,Base64Util,HttpUtil,GsonUtils请从
    * https://ai.baidu.com/file/658A35ABAB2D404FBF903F64D47C1F72
    * https://ai.baidu.com/file/C8D81F3301E24D2892968F09AE1AD6E2
    * https://ai.baidu.com/file/544D677F5D4E4F17B4122FBD60DB82B3
    * https://ai.baidu.com/file/470B3ACCA3FE43788B5A963BF0B625F3
    * 下载
    */
    public static String bankReceiptNew() {
        // 请求url
        String url = "https://aip.baidubce.com/rest/2.0/ocr/v1/bank_receipt_new";
        try {
            // 本地文件路径
            String filePath = "[本地文件路径]";
            byte[] imgData = FileUtil.readFileByBytes(filePath);
            String imgStr = Base64Util.encode(imgData);
            String imgParam = URLEncoder.encode(imgStr, "UTF-8");

            String param = "image=" + imgParam;

            // 注意这里仅为了简化编码每一次请求都去获取access_token，线上环境access_token有过期时间， 客户端可自行缓存，过期后重新获取。
            String accessToken = "[调用鉴权接口获取的token]";

            String result = HttpUtil.post(url, accessToken, param);
            System.out.println(result);
            return result;
        } catch (Exception e) {
            e.printStackTrace();
        }
        return null;
    }

    public static void main(String[] args) {
        bankReceiptNew.bankReceiptNew();
    }
}
```
```cpp label=C++
#include <iostream>
#include <curl/curl.h>

// libcurl库下载链接：https://curl.haxx.se/download.html
// jsoncpp库下载链接：https://github.com/open-source-parsers/jsoncpp/
const static std::string request_url = "https://aip.baidubce.com/rest/2.0/ocr/v1/bank_receipt_new";
static std::string bankReceiptNew_result;
/**
* curl发送http请求调用的回调函数，回调函数中对返回的json格式的body进行了解析，解析结果储存在全局的静态变量当中
* @param 参数定义见libcurl文档
* @return 返回值定义见libcurl文档
*/
static size_t callback(void *ptr, size_t size, size_t nmemb, void *stream) {
    // 获取到的body存放在ptr中，先将其转换为string格式
    bankReceiptNew_result = std::string((char *) ptr, size * nmemb);
    return size * nmemb;
}
/**
* 银行回单识别
* @return 调用成功返回0，发生错误返回其他错误码
*/
int bankReceiptNew(std::string &json_result, const std::string &access_token) {
    std::string url = request_url + "?access_token=" + access_token;
    CURL *curl = NULL;
    CURLcode result_code;
    int is_success;
    curl = curl_easy_init();
    if (curl) {
        curl_easy_setopt(curl, CURLOPT_URL, url.data());
        curl_easy_setopt(curl, CURLOPT_POST, 1);
        curl_httppost *post = NULL;
        curl_httppost *last = NULL;
        curl_formadd(&post, &last, CURLFORM_COPYNAME, "image", CURLFORM_COPYCONTENTS, "【base64_img】", CURLFORM_END);

        curl_easy_setopt(curl, CURLOPT_HTTPPOST, post);
        curl_easy_setopt(curl, CURLOPT_WRITEFUNCTION, callback);
        result_code = curl_easy_perform(curl);
        if (result_code != CURLE_OK) {
            fprintf(stderr, "curl_easy_perform() failed: %s\n",
                    curl_easy_strerror(result_code));
            is_success = 1;
            return is_success;
        }
        json_result = bankReceiptNew_result;
        curl_easy_cleanup(curl);
        is_success = 0;
    } else {
        fprintf(stderr, "curl_easy_init() failed.");
        is_success = 1;
    }
    return is_success;
}

```
```php label=PHP
<?php
/**
* 发起http post请求(REST API), 并获取REST请求的结果
* @param string $url
* @param string $param
* @return - http response body if succeeds, else false.
*/
function request_post($url = '', $param = '')
{
    if (empty($url) || empty($param)) {
        return false;
    }

    $postUrl = $url;
    $curlPost = $param;
    // 初始化curl
    $curl = curl_init();
    curl_setopt($curl, CURLOPT_URL, $postUrl);
    curl_setopt($curl, CURLOPT_HEADER, 0);
    // 要求结果为字符串且输出到屏幕上
    curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, false);
    // post提交方式
    curl_setopt($curl, CURLOPT_POST, 1);
    curl_setopt($curl, CURLOPT_POSTFIELDS, $curlPost);
    // 运行curl
    $data = curl_exec($curl);
    curl_close($curl);

    return $data;
}

$token = '[调用鉴权接口获取的token]';
$url = 'https://aip.baidubce.com/rest/2.0/ocr/v1/bank_receipt_new?access_token=' . $token;
$img = file_get_contents('[本地文件路径]');
$img = base64_encode($img);
$bodys = array(
    'image' => $img
);
$res = request_post($url, $bodys);

var_dump($res);

```
```csharp label=C#
using System;
using System.IO;
using System.Net;
using System.Text;
using System.Web;

namespace com.baidu.ai
{
    public class bankReceiptNew
    {
        // 银行回单识别
        public static string bankReceiptNew()
        {
            string token = "[调用鉴权接口获取的token]";
            string host = "https://aip.baidubce.com/rest/2.0/ocr/v1/bank_receipt_new?access_token=" + token;
            Encoding encoding = Encoding.Default;
            HttpWebRequest request = (HttpWebRequest)WebRequest.Create(host);
            request.Method = "post";
            request.KeepAlive = true;
            // 图片的base64编码
            string base64 = getFileBase64("[本地图片文件]");
            String str = "image=" + HttpUtility.UrlEncode(base64);
            byte[] buffer = encoding.GetBytes(str);
            request.ContentLength = buffer.Length;
            request.GetRequestStream().Write(buffer, 0, buffer.Length);
            HttpWebResponse response = (HttpWebResponse)request.GetResponse();
            StreamReader reader = new StreamReader(response.GetResponseStream(), Encoding.Default);
            string result = reader.ReadToEnd();
            Console.WriteLine("银行回单识别:");
            Console.WriteLine(result);
            return result;
        }

        public static String getFileBase64(String fileName) {
            FileStream filestream = new FileStream(fileName, FileMode.Open);
            byte[] arr = new byte[filestream.Length];
            filestream.Read(arr, 0, (int)filestream.Length);
            string baser64 = Convert.ToBase64String(arr);
            filestream.Close();
            return baser64;
        }
    }
}

```
返回说明
返回参数

字段	是否必选	类型	说明
log_id	是	uint64	唯一的log id，用于问题定位
pdf_file_size	否	string	传入PDF文件的总页数，当 pdf_file 参数有效时返回该字段
words_result_num	是	uint32	识别结果数，表示words_result的元素个数
words_result	是	object{}	识别结果
+ word	是	string	字段识别结果，对应标题、付款人户名、付款人开户银行、付款人账号、收款人户名、收款人开户银行、收款人账号、大写金额、小写金额、流水号、回单编号、交易日期、摘要、用途 14个字段的识别结果
+ location	否	object	字段位置信息，当请求参数 location=true 时返回该字段
++ top	否	uint32	字段的上边距
++ left	否	uint32	字段的左边距
++ height	否	uint32	字段的高度
++ width	否	uint32	字段的宽度
+ probability	否	object	字段识别结果置信度，当请求参数 probability=true 时返回该字段
++ average	否	float	字段识别结果中各字符的置信度平均值
++ min	否	float	字段识别结果中各字符的置信度最小值
返回示例

copy code
{
    "words_result_num": 14,
    "words_result": {
        "标题": [
            {
                "word": "中国工商银行网上银行电子回单"
            }
        ],
        "付款人户名": [
            {
                "word": "北京小度网络科技有限公司"
            }
        ],
        "付款人开户银行": [
            {
                "word": "北京开发区支行营业室"
            }
        ],
        "付款人账号": [
            {
                "word": "3208095919200208008"
            }
        ],
        "收款人户名": [
            {
                "word": "上海小度网络科技有限公司"
            }
        ],
        "收款人开户银行": [
            {
                "word": "工行前海支行"
            }
        ],
        "收款人账号": [
            {
                "word": "3707020802702372707"
            }
        ],
        "大写金额": [
            {
                "word": "人民币壹万陆仟贰佰叁拾玖元叁角"
            }
        ],
        "小写金额": [
            {
                "word": "￥16239.30元"
            }
        ],
        "流水号": [
            {
                "word": "27208770"
            }
        ],
        "回单编号": [
            {
                "word": "2085758711703264"
            }
        ],
        "交易日期": [
            {
                "word": ""
            }
        ],
        "摘要": [
            {
                "word": "货款"
            }
        ],
        "用途": [
            {
                "word": ""
            }
        ]
    },
    "log_id": 1630759834809123854
}
